" Plugins {{{

if empty(glob('~/.vim/autoload/plug.vim'))
    silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
        \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
endif

call plug#begin('~/.vim/plugged')

" Features
Plug 'tpope/vim-sensible'
Plug 'tpope/vim-commentary'
Plug 'tpope/vim-fugitive'
Plug 'tpope/vim-surround'
Plug 'tpope/vim-vinegar'
Plug 'justinmk/vim-sneak'
Plug 'matze/vim-move'
Plug 'junegunn/vim-peekaboo'
Plug 'junegunn/fzf', { 'do': './install --bin' }
Plug 'junegunn/fzf.vim'
Plug 'airblade/vim-gitgutter'
Plug 'terryma/vim-multiple-cursors'

" Languages
Plug 'octol/vim-cpp-enhanced-highlight', { 'for': 'cpp' }
Plug 'rust-lang/rust.vim', { 'for': 'rust' }
Plug 'keith/swift.vim', { 'for': 'swift' }
Plug 'pangloss/vim-javascript', { 'for': 'javascript' }
Plug 'mxw/vim-jsx', { 'for': 'javascript' }
Plug 'dag/vim-fish', { 'for': 'fish' }
Plug 'junegunn/goyo.vim', { 'for': 'markdown' }

" Visual/themes
Plug 'chriskempson/base16-vim'
Plug 'arcticicestudio/nord-vim'
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'

call plug#end()

" }}}

" Plugin configuration {{{

" netrw
let g:netrw_liststyle = 3

" GitGutter
let g:gitgutter_eager = 1
let g:gitgutter_realtime = 1
let g:gitgutter_override_sign_column_highlight = 0
set signcolumn=yes

" Airline
let g:airline#extensions#tabline#enabled = 1
let g:airline_theme = 'base16'

" }}}

" Options {{{

" UI
set number
set showmatch
set matchtime=2
set whichwrap+=h,l
set updatetime=500
set belloff=all

" Searching
set ignorecase
set smartcase

" Tabs
set splitbelow
set splitright

" Always replace tabs with 4 spaces
retab
set expandtab
set shiftwidth=4
set tabstop=4

" Indentation
set smartindent
set wrap

" Ignore certain files and directories
set wildignore+=*.o,*~,*.pyc,*/.git/*,*/node_modules/*
set viminfo=
set noswapfile

" Set language specific options
autocmd Filetype haskell setlocal tabstop=2 shiftwidth=2
autocmd Filetype javascript setlocal tabstop=2 shiftwidth=2
autocmd Filetype ruby setlocal tabstop=2 shiftwidth=2
autocmd Filetype swift setlocal tabstop=2 shiftwidth=2

" }}}

" Colour scheme {{{

set background=dark
let base16colorspace=256
silent! colorscheme base16-oceanicnext
highlight LineNr ctermbg=black
highlight SignColumn ctermbg=black

" }}}

" Keybindings {{{

" Quick leader actions
let mapleader = "\\"

" Disable highlight
nnoremap <silent> <Esc> :nohlsearch<Bar>:echo<cr>
nnoremap <silent> <C-C> :nohlsearch<Bar>:echo<cr>
nnoremap <silent> <C-[> :nohlsearch<Bar>:echo<cr>
nnoremap <silent> <leader><space> :noh<cr>

" Fast actions
nmap <leader>w :write<cr>
nmap <leader>x :exit<cr>
nmap <leader>q :quit<cr>
nmap <leader>Q :quitall<cr>
nmap <leader>f :Files<cr>
nmap <leader>b :Buffers<cr>
nmap <leader>c :Commands<cr>
nmap <leader>r :redraw!<cr>

" Jump to definition/between headers
nnoremap <F2> gD

" fzf
nnoremap <F9> :Files<cr>
nnoremap <F10> :Buffers<cr>
nnoremap <C-p> :GFiles<cr>

" Sneak
nmap f <Plug>Sneak_f
nmap F <Plug>Sneak_F
xmap f <Plug>Sneak_f
xmap F <Plug>Sneak_F
omap f <Plug>Sneak_f
omap F <Plug>Sneak_F
nmap t <Plug>Sneak_t
nmap T <Plug>Sneak_T
xmap t <Plug>Sneak_t
xmap T <Plug>Sneak_T
omap t <Plug>Sneak_t
omap T <Plug>Sneak_T

" iVim
map <D-o> :idocuments<cr>
map <D-e> :edit .<cr>
map <D-s> :write<cr>
map <D-r> :redraw!<cr>
map <D-t> :tabnew<cr>
map <D-w> :bd<cr>
map <D-q> :quit<cr>
map <D-}> :tabnext<cr>
map <D-{> :tabprev<cr>
map <D-p> :ishare<cr>

" }}}

" vim:foldmethod=marker:foldlevel=0
