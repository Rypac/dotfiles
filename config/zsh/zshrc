[ -f "$ZDOTDIR/aliases" ] && source "$ZDOTDIR/aliases"
[ -f "$ZDOTDIR/completions" ] && source "$ZDOTDIR/completions"
[ -f "$ZDOTDIR/colours" ] && source "$ZDOTDIR/colours"
[ -f "$ZDOTDIR/env" ] && source "$ZDOTDIR/env"
[ -f "$ZDOTDIR/keybindings" ] && source "$ZDOTDIR/keybindings"
[ -f "$ZDOTDIR/opts" ] && source "$ZDOTDIR/opts"
[ -f "$ZDOTDIR/prompt" ] && source "$ZDOTDIR/prompt"

# History substring search
if [ -d "$ZDOTDIR/zsh-history-substring-search" ]; then
    source "$ZDOTDIR/zsh-history-substring-search/zsh-history-substring-search.zsh"
    bindkey '^[[A' history-substring-search-up
    bindkey '^[[B' history-substring-search-down
    bindkey -M vicmd 'k' history-substring-search-up
    bindkey -M vicmd 'j' history-substring-search-down
fi

# Fuzzy command line search
if [ -d "$XDG_CONFIG_HOME/fzf" ]; then
    export PATH="$XDG_CONFIG_HOME/fzf/bin:$PATH"
    export MANPATH="$MANPATH:$XDG_CONFIG_HOME/fzf/man"
    source "$XDG_CONFIG_HOME/fzf/shell/completion.zsh" 2> /dev/null
fi

# Enhancd
if [ -f "$HOME/scripts/enhancd.sh" ]; then
    export ENHANCD_DIR="$XDG_DATA_HOME/enhancd"
    source "$HOME/scripts/enhancd.sh"
fi

# De-duplicate array paths
typeset -gU cdpath fpath mailpath path

if (( $#commands[(i)lesspipe(|.sh)] )); then
    export LESSOPEN="| /usr/bin/env $commands[(i)lesspipe(|.sh)] %s 2>&-"
fi

# Temporary Files
if [ ! -d "$TMPDIR" ]; then
    export TMPDIR="/tmp/$LOGNAME"
    mkdir -p -m 700 "$TMPDIR"
fi

TMPPREFIX="${TMPDIR%/}/zsh"
