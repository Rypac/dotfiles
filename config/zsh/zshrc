#
# Executes commands at the start of an interactive session.
#

# Export home path
if [ -d "$HOME/bin" ]; then
    export PATH="$HOME/bin:$PATH"
fi

# Load zim plugins
if [ -s "$ZDOTDIR/.zim/init.zsh" ]; then
    source "$ZDOTDIR/.zim/init.zsh"
fi

# Load OS specific configuration
if [ -s "$ZDOTDIR/.zshrc.env" ]; then
    source "$ZDOTDIR/.zshrc.env"
fi

# Docker
if [ $commands[docker] ]; then
    alias docker-stop="$HOME/scripts/docker/stop_all_containers.sh"
    alias docker-clean="$HOME/scripts/docker/remove_all_containers.sh"
    alias docker-purge="$HOME/scripts/docker/remove_all_images.sh"
fi

# Clipboard
if [ $commands[xclip] ]; then
    alias setclip='xclip -selection clipboard -i'
    alias getclip='xclip -selection clipboard -o'
fi

# Fuzzy command line search
if [ -d "$XDG_CONFIG_HOME/fzf" ]; then
    export FZF_COMPLETION_TRIGGER='~~'
    export PATH="$PATH:$XDG_CONFIG_HOME/fzf/bin"
    export MANPATH="$MANPATH:$XDG_CONFIG_HOME/fzf/man"
    source "$XDG_CONFIG_HOME/fzf/shell/completion.zsh" 2> /dev/null
fi

# Enhancd
if [ -s "$HOME/scripts/enhancd.sh" ]; then
    export ENHANCD_DIR="$XDG_DATA_HOME/enhanced"
    source "$HOME/scripts/enhancd.sh"
fi

# Bundle
if [ $commands[bundle] ]; then
    alias be='bundle exec'
    alias ber='bundle exec rake'
fi

# Rust
if [ "$CARGO_HOME" ]; then
    export PATH="$PATH:$CARGO_HOME/bin"
fi

# Common tool aliases
alias j='z'
alias jj='zz'
alias la='ls -lAh'
alias mkdir='mkdir -p'
alias less='less -FSRXc'
alias qfind='find . -name'
alias prettyjson='python -m json.tool'

# Keybindings
bindkey '[C' forward-word         # alt+left
bindkey '[D' backward-word        # alt+right
bindkey '^0[C' forward-word       # ctrl+left
bindkey '^0[D' backward-word      # ctrl+right
bindkey '^[[3^' kill-word         # ctrl+delete
bindkey '^H' backward-kill-word   # ctrl+backspace
bindkey '^K' kill-line            # ctrl+k
bindkey '^U' backward-kill-line   # ctrl+u
bindkey '^T' transpose-chars      # ctrl+t
bindkey '^P' up-history           # ctrl+p
bindkey '^N' down-history         # ctrl+n
bindkey '^R' history-incremental-search-backward # ctrl+r
export KEYTIMEOUT=1
